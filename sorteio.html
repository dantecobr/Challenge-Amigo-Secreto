<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>In칤cio - Gerenciador de Amigo Secreto</title>
    <style>
        /* ESTILOS CSS PARA MELHORAR O VISUAL */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; background-color: #f4f7f6; color: #333; }
        .container { max-width: 900px; margin: 0 auto; background-color: #fff; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); }
        h1 { color: #007bff; border-bottom: 2px solid #007bff; padding-bottom: 10px; margin-top: 0; }
        h2 { color: #333; border-bottom: 2px solid #e0e0e0; padding-bottom: 8px; margin-top: 30px; }
        
        /* Estilos do Formul치rio */
        .form-group { margin-bottom: 15px; display: flex; gap: 10px; }
        .form-group input { padding: 10px; border: 1px solid #ccc; border-radius: 5px; flex-grow: 1; }
        .form-group button { background-color: #28a745; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; transition: background-color 0.3s; }
        .form-group button:hover { background-color: #1e7e34; }

        /* Estilos do Bot칚o Principal */
        #btn-sortear { padding: 15px 25px; font-size: 18px; cursor: pointer; background-color: #d9534f; color: white; border: none; border-radius: 8px; transition: background-color 0.3s; width: 100%; margin-top: 20px; margin-bottom: 30px; font-weight: bold; }
        #btn-sortear:hover { background-color: #c9302c; }

        /* Lista de Participantes */
        #lista-participantes { list-style: none; padding: 0; }
        #lista-participantes li { background-color: #e9ecef; padding: 10px 15px; border-radius: 5px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; font-size: 0.95em; }
        .remover-btn { background-color: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 0.8em; transition: background-color 0.3s; }
        .remover-btn:hover { background-color: #c82333; }
        
        /* Links Prontos */
        .links-header { color: #5cb85c; margin-top: 40px; font-weight: bold; }
        .link-pronto { background-color: #e6ffe6; padding: 15px; margin-top: 10px; border-radius: 5px; border-left: 5px solid #28a745; word-wrap: break-word; }
        .link-pronto a { color: #007bff; font-weight: bold; text-decoration: none; }
        code { background-color: #eee; padding: 2px 4px; border-radius: 3px; font-size: 0.9em; }

        /* Alertas e avisos */
        .alerta { background-color: #ffc107; padding: 12px; border-radius: 5px; margin-bottom: 20px; color: #333; font-weight: 500; }
    </style>
</head>
<body>

    <div class="container">
        <h1>游꾸 Gerenciador de Sorteio de Amigo Secreto</h1>
        <p class="alerta">
            <strong>ATEN칂츾O:</strong> Esta 칠 a p치gina de administra칞칚o. O link de revela칞칚o que ser치 enviado aos participantes 칠 a <code>revelacao.html</code>.
        </p>

        <h2>1. Adicionar Novo Participante</h2>
        <div class="form-group">
            <input type="text" id="input-nome" placeholder="Nome Completo" required>
            <input type="text" id="input-zap" placeholder="WhatsApp (Ex: 5584999999999)" required>
            <button onclick="adicionarParticipante()">Adicionar  Lista</button>
        </div>
        
        <h2>2. Lista Atual de Participantes (<span id="count-participantes">0</span>)</h2>
        <ul id="lista-participantes">
            </ul>
        
        <hr>
        <h2 class="links-header">3. Realizar Sorteio e Enviar</h2>
        <button id="btn-sortear" onclick="realizarSorteio()">游댠 Realizar Sorteio e Gerar Links</button>
        
        <h3>Links Prontos para Envio:</h3>
        <div id="links-de-envio">
            <p>A lista de links aparecer치 aqui ap칩s o sorteio.</p>
        </div>
    </div>

    <script>
        // =======================================================
        // 1. DADOS INICIAIS (COM TODAS AS REGRAS E ZAPS)
        // =======================================================
        let participantes = [
            { nome: "Ana Clara", zap: "558496634604", amigoSecreto: "" },
            { nome: "Dante Marques", zap: "558496013344", amigoSecreto: "" },
            { nome: "Kallyny", zap: "558487938890", amigoSecreto: "" },
            { nome: "Rodolfo", zap: "558499303180", amigoSecreto: "" },
            { nome: "J칰lia", zap: "558499303180", amigoSecreto: "" }, // ZAP: Rodolfo
            { nome: "Ana Maria", zap: "558499101380", amigoSecreto: "" },
            { nome: "Ronaldo", zap: "558487464446", amigoSecreto: "" },
            { nome: "Ton", zap: "558496636715", amigoSecreto: "" },
            { nome: "Anny Kelly", zap: "558487848323", amigoSecreto: "" },
            { nome: "Gl치ucio", zap: "558496104467", amigoSecreto: "" },
            { nome: "Ay칪", zap: "558496104467", amigoSecreto: "" }, // ZAP: Gl치ucio
            { nome: "Ravi", zap: "558499303180", amigoSecreto: "" } // ZAP: Rodolfo
        ];

        // =======================================================
        // 2. CONFIGURA칂츾O DA URL DE REVELA칂츾O (MANTIDA)
        // =======================================================
        const urlBaseRevelacao = "revelacao.html"; 

        // =======================================================
        // FUN칂칏ES PARA GERENCIAR A LISTA DINAMICAMENTE
        // =======================================================

        function renderizarLista() {
            const ul = document.getElementById('lista-participantes');
            ul.innerHTML = '';
            document.getElementById('count-participantes').textContent = participantes.length;
            
            if (participantes.length === 0) {
                ul.innerHTML = '<li>Nenhum participante na lista. Adicione um!</li>';
                return;
            }

            participantes.forEach((p, index) => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <strong>${p.nome}</strong> - ZAP: ${p.zap || 'N/A'}
                    <button class="remover-btn" onclick="removerParticipante(${index})">Remover</button>
                `;
                ul.appendChild(li);
            });
        }
        
        function adicionarParticipante() {
            const nomeInput = document.getElementById('input-nome');
            const zapInput = document.getElementById('input-zap');
            
            const nome = nomeInput.value.trim();
            const zap = zapInput.value.trim().replace(/\D/g, ''); // Remove n칚o-d칤gitos
            
            if (nome === "") {
                alert("O campo Nome 칠 obrigat칩rio.");
                return;
            }

            // Verifica se o WhatsApp est치 no formato 55 DDD NUMERO
            if (zap.length < 12 || !zap.startsWith('55')) {
                 if (confirm("O n칰mero do WhatsApp parece incompleto (Use 55 DDD N칔MERO). Deseja adicionar mesmo assim?")) {
                    // Continua com o n칰mero incompleto ou vazio
                 } else {
                    return;
                 }
            }

            // Adiciona o novo participante no array
            participantes.push({ 
                nome: nome, 
                zap: zap, 
                amigoSecreto: "" 
            });

            // Limpa o formul치rio e atualiza a lista visual
            nomeInput.value = '';
            zapInput.value = '';
            renderizarLista();
        }

        function removerParticipante(index) {
            if (confirm(`Tem certeza que deseja remover ${participantes[index].nome}?`)) {
                participantes.splice(index, 1);
                renderizarLista();
            }
        }

        // =======================================================
        // 3. L칍GICA DE SORTEIO E REGRAS ESPECIAIS (MANTIDA)
        // =======================================================

        function realizarSorteio() {
            if (participantes.length < 2) {
                alert("칄 necess치rio pelo menos dois participantes para sortear!");
                return;
            }

            // Reseta os sorteios
            participantes.forEach(p => p.amigoSecreto = "");

            const nomes = participantes.map(p => p.nome);
            
            // Nomes que precisam ser sorteados para algu칠m
            let nomesDisponiveis = [...nomes];

            // --- APLICAR REGRAS FIXAS ---
            
            const regrasFixas = [
                { quemSorteia: "J칰lia", sorteia: "Ana Maria" }, 
                { quemSorteia: "Rodolfo", sorteia: "Ronaldo" }
            ];

            const pessoasJaSorteadas = [];

            for (const regra of regrasFixas) {
                const sorteador = participantes.find(p => p.nome === regra.quemSorteia);
                if (sorteador) {
                    sorteador.amigoSecreto = regra.sorteia;
                    pessoasJaSorteadas.push(regra.quemSorteia);
                    
                    const idx = nomesDisponiveis.indexOf(regra.sorteia);
                    if (idx > -1) {
                        nomesDisponiveis.splice(idx, 1);
                    }
                }
            }

            // --- REALIZAR SORTEIO ALEAT칍RIO PARA O RESTANTE ---
            
            const participantesParaSortear = participantes.filter(p => !pessoasJaSorteadas.includes(p.nome));
            
            let sucesso = false;
            let tentativas = 0;
            
            while (!sucesso && tentativas < 100) {
                tentativas++;
                const listaEmbaralhada = [...nomesDisponiveis].sort(() => 0.5 - Math.random());
                sucesso = true;
                
                for (let i = 0; i < participantesParaSortear.length; i++) {
                    const pessoa = participantesParaSortear[i];
                    const sorteado = listaEmbaralhada[i];
                    
                    if (pessoa.nome === sorteado) {
                        sucesso = false; 
                        break; 
                    }
                }

                if (sucesso) {
                    for (let i = 0; i < participantesParaSortear.length; i++) {
                        participantesParaSortear[i].amigoSecreto = listaEmbaralhada[i];
                    }
                }
            }
            
            if (tentativas >= 100) {
                alert("Falha no sorteio aleat칩rio. Tente novamente ou verifique se as regras fixas tornam o sorteio imposs칤vel.");
                return;
            }

            // GERA칂츾O DOS LINKS
            gerarLinksWhatsApp();
        }
        
        function getRecipientInfo(participante) {
            let recipientName = participante.nome;
            let recipientZap = participante.zap;
            let drawnName = participante.amigoSecreto;
            
            // --- L칩gica de Ay칪 (Pais: Gl치ucio e Anny Kelly) ---
            if (participante.nome === "Ay칪") {
                const glauzio = participantes.find(p => p.nome === "Gl치ucio");
                const anny = participantes.find(p => p.nome === "Anny Kelly");
                
                if (drawnName === "Gl치ucio" && anny) {
                    recipientName = `Anny Kelly (Respons치vel por Ay칪)`;
                    recipientZap = anny.zap;
                } else if (drawnName === "Anny Kelly" && glauzio) {
                    recipientName = `Gl치ucio (Respons치vel por Ay칪)`;
                    recipientZap = glauzio.zap;
                } else if (glauzio) {
                    recipientName = `Gl치ucio (Respons치vel por Ay칪)`;
                    recipientZap = glauzio.zap;
                }
            }

            // --- L칩gica de Ravi (Pai: Rodolfo / Conflito: Ana Maria) ---
            if (participante.nome === "Ravi") {
                const rodolfo = participantes.find(p => p.nome === "Rodolfo");
                const anamaria = participantes.find(p => p.nome === "Ana Maria"); 

                if (drawnName === "Rodolfo" && anamaria) {
                    recipientName = `Ana Maria (Respons치vel por Ravi)`; 
                    recipientZap = anamaria.zap;
                } else if (rodolfo) {
                    recipientName = `Rodolfo (Respons치vel por Ravi)`;
                    recipientZap = rodolfo.zap;
                }
            }

            // --- L칩gica de J칰lia (Respons치vel: Rodolfo) ---
            if (participante.nome === "J칰lia") {
                const rodolfo = participantes.find(p => p.nome === "Rodolfo"); 
                if (rodolfo) {
                    recipientName = `Respons치vel por J칰lia (${rodolfo.nome})`;
                    recipientZap = rodolfo.zap;
                }
            }

            return { recipientName, recipientZap, drawnName };
        }
        
        function gerarLinksWhatsApp() {
            const container = document.getElementById('links-de-envio');
            container.innerHTML = ''; 

            participantes.forEach(p => {
                const { recipientName, recipientZap, drawnName } = getRecipientInfo(p);
                
                if (!recipientZap || recipientZap.length < 10) {
                     const divElement = document.createElement('div');
                     divElement.classList.add('link-pronto');
                     divElement.style.backgroundColor = '#f8d7da';
                     divElement.innerHTML = `<p><strong>ERRO:</strong> ${p.nome} / ${recipientName} n칚o tem n칰mero de WhatsApp v치lido. Sorteado: ${drawnName}. Envie o link <code>${urlBaseRevelacao}#${encodeURIComponent(drawnName)}</code> manualmente.</p>`;
                     container.appendChild(divElement);
                     return;
                }

                const linkRevelacao = `${urlBaseRevelacao}#${encodeURIComponent(drawnName)}`;
                const mensagem = `游봅 Ol치, ${recipientName}! Voc칡 est치 recebendo o link do Amigo Secreto de *${p.nome}*. O Amigo Secreto sorteado para ${p.nome} 칠: ${linkRevelacao}%0A%0A_Aten칞칚o: N칚o compartilhe este link!_`;
                const linkWhatsApp = `https://wa.me/${recipientZap}?text=${encodeURIComponent(mensagem)}`;

                const divElement = document.createElement('div');
                divElement.classList.add('link-pronto');
                divElement.innerHTML = `
                    <p><strong>Para: ${p.nome}</strong> | Destinat치rio do Zap: <strong>${recipientName}</strong></p>
                    <a href="${linkWhatsApp}" target="_blank">游 Clique para Abrir o WhatsApp e Enviar</a>
                    <p style="font-size: 0.8em; margin-top: 5px;">Link Gerado: <code>${linkRevelacao}</code></p>
                `;
                container.appendChild(divElement);
            });
        }
        
        // Inicializa a lista ao carregar a p치gina
        window.onload = renderizarLista;
    </script>
</body>
</html>
