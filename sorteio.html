<script>
        // =======================================================
        // 1. DADOS INICIAIS (COM CORRE칂츾O PARA ZAP DA J칔LIA)
        // =======================================================
        let participantes = [
            // Os dados aqui ser칚o carregados para a lista visual!
            // Os campos 'amigoSecreto' e 'parentInfo' ser칚o preenchidos durante o sorteio.
            { nome: "Ana Clara", zap: "558496634604", amigoSecreto: "" },
            { nome: "Dante Marques", zap: "558496013344", amigoSecreto: "" },
            { nome: "Kallyny", zap: "558487938890", amigoSecreto: "" },
            { nome: "Rodolfo", zap: "558499303180", amigoSecreto: "" },
            // ZAP ATUALIZADO: J칰lia usa o ZAP de Rodolfo
            { nome: "J칰lia", zap: "558499303180", amigoSecreto: "" }, 
            { nome: "Ana Maria", zap: "558499101380", amigoSecreto: "" },
            { nome: "Ronaldo", zap: "558487464446", amigoSecreto: "" },
            { nome: "Ton", zap: "558496636715", amigoSecreto: "" },
            { nome: "Anny Kelly", zap: "558487848323", amigoSecreto: "" },
            { nome: "Gl치ucio", zap: "558496104467", amigoSecreto: "" },
            { nome: "Ay칪", zap: "558496104467", amigoSecreto: "" },
            { nome: "Ravi", zap: "558499303180", amigoSecreto: "" }
        ];

        // =======================================================
        // 2. CONFIGURA칂츾O DA URL DE REVELA칂츾O (MANTIDA)
        // =======================================================
        const urlBaseRevelacao = "revelacao.html"; 

        // =======================================================
        // FUN칂칏ES PARA GERENCIAR A LISTA DINAMICAMENTE
        // =======================================================

        function renderizarLista() {
            const ul = document.getElementById('lista-participantes');
            ul.innerHTML = '';
            
            if (participantes.length === 0) {
                ul.innerHTML = '<li>Nenhum participante na lista. Adicione um!</li>';
                return;
            }

            participantes.forEach((p, index) => {
                const li = document.createElement('li');
                li.innerHTML = `
                    ${p.nome} - ZAP: ${p.zap || 'N/A'}
                    <button class="remover-btn" onclick="removerParticipante(${index})">Remover</button>
                `;
                ul.appendChild(li);
            });
        }
        
        function adicionarParticipante() {
            const nomeInput = document.getElementById('input-nome');
            const zapInput = document.getElementById('input-zap');
            
            const nome = nomeInput.value.trim();
            const zap = zapInput.value.trim().replace(/\D/g, ''); // Remove n칚o-d칤gitos
            
            if (nome === "") {
                alert("O campo Nome 칠 obrigat칩rio.");
                return;
            }

            // Verifica se o WhatsApp est치 no formato 55 DDD NUMERO
            if (zap.length < 12 || !zap.startsWith('55')) {
                 if (confirm("O n칰mero do WhatsApp parece incompleto (Use 55 DDD N칔MERO). Deseja adicionar mesmo assim?")) {
                    // Continua com o n칰mero incompleto ou vazio
                 } else {
                    return;
                 }
            }

            // Adiciona o novo participante no array
            participantes.push({ 
                nome: nome, 
                zap: zap, 
                amigoSecreto: "" 
            });

            // Limpa o formul치rio e atualiza a lista visual
            nomeInput.value = '';
            zapInput.value = '';
            renderizarLista();
        }

        function removerParticipante(index) {
            if (confirm(`Tem certeza que deseja remover ${participantes[index].nome}?`)) {
                participantes.splice(index, 1);
                renderizarLista();
            }
        }

        // =======================================================
        // 3. L칍GICA DE SORTEIO E REGRAS ESPECIAIS (N츾O ALTERADA)
        // =======================================================

        function realizarSorteio() {
            if (participantes.length < 2) {
                alert("칄 necess치rio pelo menos dois participantes para sortear!");
                return;
            }

            // Reseta os sorteios
            participantes.forEach(p => p.amigoSecreto = "");

            const nomes = participantes.map(p => p.nome);
            
            // Nomes que precisam ser sorteados para algu칠m
            let nomesDisponiveis = [...nomes];

            // --- APLICAR REGRAS FIXAS ---
            
            const regrasFixas = [
                { quemSorteia: "J칰lia", sorteia: "Ana Maria" }, 
                { quemSorteia: "Rodolfo", sorteia: "Ronaldo" }
            ];

            const pessoasJaSorteadas = [];

            for (const regra of regrasFixas) {
                const sorteador = participantes.find(p => p.nome === regra.quemSorteia);
                if (sorteador) {
                    sorteador.amigoSecreto = regra.sorteia;
                    pessoasJaSorteadas.push(regra.quemSorteia);
                    
                    const idx = nomesDisponiveis.indexOf(regra.sorteia);
                    if (idx > -1) {
                        nomesDisponiveis.splice(idx, 1);
                    }
                }
            }

            // --- REALIZAR SORTEIO ALEAT칍RIO PARA O RESTANTE ---
            
            const participantesParaSortear = participantes.filter(p => !pessoasJaSorteadas.includes(p.nome));
            
            let sucesso = false;
            let tentativas = 0;
            
            while (!sucesso && tentativas < 100) {
                tentativas++;
                const listaEmbaralhada = [...nomesDisponiveis].sort(() => 0.5 - Math.random());
                sucesso = true;
                
                for (let i = 0; i < participantesParaSortear.length; i++) {
                    const pessoa = participantesParaSortear[i];
                    const sorteado = listaEmbaralhada[i];
                    
                    if (pessoa.nome === sorteado) {
                        sucesso = false; 
                        break; 
                    }
                }

                if (sucesso) {
                    for (let i = 0; i < participantesParaSortear.length; i++) {
                        participantesParaSortear[i].amigoSecreto = listaEmbaralhada[i];
                    }
                }
            }
            
            if (tentativas >= 100) {
                alert("Falha no sorteio aleat칩rio. Tente novamente ou verifique se as regras fixas tornam o sorteio imposs칤vel.");
                return;
            }

            // GERA칂츾O DOS LINKS
            gerarLinksWhatsApp();
        }
        
        function getRecipientInfo(participante) {
            let recipientName = participante.nome;
            let recipientZap = participante.zap;
            let drawnName = participante.amigoSecreto;
            
            // --- L칩gica de Ay칪 (Pais: Gl치ucio e Anny Kelly) ---
            if (participante.nome === "Ay칪") {
                const glauzio = participantes.find(p => p.nome === "Gl치ucio");
                const anny = participantes.find(p => p.nome === "Anny Kelly");
                
                if (drawnName === "Gl치ucio" && anny) {
                    recipientName = `Anny Kelly (Respons치vel por Ay칪)`;
                    recipientZap = anny.zap;
                } else if (drawnName === "Anny Kelly" && glauzio) {
                    recipientName = `Gl치ucio (Respons치vel por Ay칪)`;
                    recipientZap = glauzio.zap;
                } else if (glauzio) {
                    recipientName = `Gl치ucio (Respons치vel por Ay칪)`;
                    recipientZap = glauzio.zap;
                }
            }

            // --- L칩gica de Ravi (Pai: Rodolfo / Conflito: Ana Maria) ---
            if (participante.nome === "Ravi") {
                const rodolfo = participantes.find(p => p.nome === "Rodolfo");
                const anamaria = participantes.find(p => p.nome === "Ana Maria"); 

                if (drawnName === "Rodolfo" && anamaria) {
                    recipientName = `Ana Maria (Respons치vel por Ravi)`; 
                    recipientZap = anamaria.zap;
                } else if (rodolfo) {
                    recipientName = `Rodolfo (Respons치vel por Ravi)`;
                    recipientZap = rodolfo.zap;
                }
            }

            // --- L칩gica de J칰lia (Respons치vel: Rodolfo) ---
            if (participante.nome === "J칰lia") {
                // DESTINAT츼RIO ATUALIZADO: Rodolfo
                const rodolfo = participantes.find(p => p.nome === "Rodolfo"); 
                if (rodolfo) {
                    recipientName = `Respons치vel por J칰lia (${rodolfo.nome})`;
                    recipientZap = rodolfo.zap;
                }
            }

            return { recipientName, recipientZap, drawnName };
        }
        
        function gerarLinksWhatsApp() {
            const container = document.getElementById('links-de-envio');
            container.innerHTML = ''; 

            participantes.forEach(p => {
                const { recipientName, recipientZap, drawnName } = getRecipientInfo(p);
                
                if (!recipientZap || recipientZap.length < 10) {
                     const divElement = document.createElement('div');
                     divElement.classList.add('link-pronto');
                     divElement.style.backgroundColor = '#f8d7da';
                     divElement.innerHTML = `<p><strong>ERRO:</strong> ${p.nome} / ${recipientName} n칚o tem n칰mero de WhatsApp v치lido. Sorteado: ${drawnName}. Envie o link <code>${urlBaseRevelacao}#${encodeURIComponent(drawnName)}</code> manualmente.</p>`;
                     container.appendChild(divElement);
                     return;
                }

                const linkRevelacao = `${urlBaseRevelacao}#${encodeURIComponent(drawnName)}`;
                const mensagem = `游봅 Ol치, ${recipientName}! Voc칡 est치 recebendo o link do Amigo Secreto de *${p.nome}*. O Amigo Secreto sorteado para ${p.nome} 칠: ${linkRevelacao}%0A%0A_Aten칞칚o: N칚o compartilhe este link!_`;
                const linkWhatsApp = `https://wa.me/${recipientZap}?text=${encodeURIComponent(mensagem)}`;

                const divElement = document.createElement('div');
                divElement.classList.add('link-pronto');
                divElement.innerHTML = `
                    <p><strong>Para: ${p.nome}</strong> | Destinat치rio do Zap: <strong>${recipientName}</strong></p>
                    <a href="${linkWhatsApp}" target="_blank">游 Clique para Abrir o WhatsApp e Enviar</a>
                    <p style="font-size: 0.8em; margin-top: 5px;">Link Gerado: <code>${linkRevelacao}</code></p>
                `;
                container.appendChild(divElement);
            });
        }
        
        // Inicializa a lista ao carregar a p치gina
        window.onload = renderizarLista;
    </script>
